n = 16;
% maxerr = [0.003762714917025;
%           1.912797084195894e-04;
%           1.106149708851589e-05;
%           6.984492997297309e-07;
%           3.257050273930417e-07;];

% Error is max(strip, bulk)
nleaf = [1393;   % 1e-0
         2551;   % 1e-1
         3526;   % 1e-2
         4822;   % 1e-3
         6322;   % 1e-4
         8071;   % 1e-5
         10510;  % 1e-6
         13948]; % 1e-7
maxerr = [0.004667048954933;
          1.653811892097234e-04;
          1.328562591362825e-05;
          1.394195626724937e-07;
          6.171313216007945e-08;
          1.655633985464533e-08;
          5.181657047881316e-10;
          1.631926399570105e-10]; % Strip is 3.83716e-10
      
loglog(nleaf, maxerr, 'ko-', 'linewidth', 1)
hold on
loglog(nleaf, 1e24*nleaf.^-8, 'k--', 'linewidth', 1)
shg

%% Circle
nleaf = [91;  % 1e-0
         175; % 1e-1
         346]; % 1e-2
maxerr = [0.004010433724844;
          5.992201506016537e-04;
          6.157229307145462e-04;
          5.992201506016537e-04];
semilogy(nleaf, maxerr, 'ko-', 'linewidth', 1)
shg

%% Circle low degree f

nleaf = [1; 28; 88; 268; 376; 724]; % 1e-0 to 1e-4
maxerr = [0.036692111852662;
          0.001912782040598;
          0.001833421995395;
          4.342132115461861e-06;
          3.460203431927822e-06;
          1.661226858157283e-08];
semilogy(nleaf, maxerr, 'ko-', 'linewidth', 1)
shg
          
%% Ellipse
nleaf = [319; 682; 979; 1345; 1831; 2380; 3034]; % 1e-0 to 1e-5
maxerr = [0.004248312745891;
          1.339358858258866e-04;
          1.244124149935022e-05;
          4.854032688017540e-07;
          2.828468848026233e-08;
          6.181107070624137e-09;
          6.174966427074935e-09];
loglog(nleaf, maxerr, 'ko-', 'linewidth', 1)
%semilogy(nleaf, maxerr, 'ko-', 'linewidth', 1)
hold on
nn = nleaf(2:end);
loglog(nn, 1e20*nn.^-8, 'k--', 'linewidth', 1)
shg

%% Ellipse 5:1
nleaf = [832; 1204; 1528; 1960; 2464]; % 1e-4 to 1e-8
maxerr = [1.554366905465177e-06;
          9.18522e-09;
          4.285835020212403e-10;
          4.287578070361064e-10;
          8.753886504564434e-12];
semilogy(nleaf, maxerr, 'ko-', 'linewidth', 1)
shg
